<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="Tester Chen">
<meta property="og:url" content="http://chainradar.cn/page/3/index.html">
<meta property="og:site_name" content="Tester Chen">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Tester Chen">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://chainradar.cn/page/3/">





  <title>Tester Chen</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Tester Chen</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br>
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://chainradar.cn/2018/08/08/面试准备--Linux/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CHEN JIAN PING">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tester Chen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/08/08/面试准备--Linux/" itemprop="url">面试准备--Linux</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-08-08T06:06:00+08:00">
                2018-08-08
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/面试/" itemprop="url" rel="index">
                    <span itemprop="name">面试</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="TAIL"><a href="#TAIL" class="headerlink" title="TAIL"></a>TAIL</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看动态日志，不断有内容被打印出来. 这时候中断第一个进程Ctrl-C</span></span><br><span class="line">tail -f test.log</span><br><span class="line"></span><br><span class="line"><span class="comment"># 实时监控最近100行日志，并显示行号</span></span><br><span class="line">tail -100fn test.log</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示最后1000行</span></span><br><span class="line">tail -n 1000 test.log</span><br><span class="line"></span><br><span class="line"><span class="comment"># 从1000行开始显示，显示1000行以后内容</span></span><br><span class="line">tail -n +1000 test.log</span><br></pre></td></tr></table></figure>
<h3 id="VI-VIM"><a href="#VI-VIM" class="headerlink" title="VI/VIM"></a>VI/VIM</h3><p>vi可用于创建和修改文件，vi编辑器中如何查找内容？<br>按下”/“键，这时在状态栏（也就是屏幕左下脚）就出现了 “/” 然后输入你要查找的关键字敲回车就可以了。<br>找到相关文字以后： （1）按下小写n，向下查找 （2）按下大写N，向上查找。</p>
<h3 id="MORE-LESS"><a href="#MORE-LESS" class="headerlink" title="MORE/LESS"></a>MORE/LESS</h3><p>查看静态文件，翻页显示日志，less可以向前翻。</p>
<h3 id="统计关键词"><a href="#统计关键词" class="headerlink" title="统计关键词"></a>统计关键词</h3><p>linux查找某个文件中单词出现的次数<br>文件名称：list.log，查找单词名称：test<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">more list.log | grep -o <span class="built_in">test</span> | wc -l</span><br><span class="line">cat list.log | grep -o <span class="built_in">test</span> | wc -l</span><br><span class="line">grep -o <span class="built_in">test</span> list.log | wc -l</span><br></pre></td></tr></table></figure></p>
<h3 id="SED"><a href="#SED" class="headerlink" title="SED"></a>SED</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询某个时间段日志：</span></span><br><span class="line">sed -n ‘/2010-11-17 09:25:55/,/2010-11-17 09:25:55/p’  logfile</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询某时间段到现在的日志：</span></span><br><span class="line">sed -n ‘/2010-11-17 09:25:55/,<span class="variable">$p</span>’  logfile</span><br></pre></td></tr></table></figure>
<h3 id="HEAD"><a href="#HEAD" class="headerlink" title="HEAD"></a>HEAD</h3><p>跟tail是相反的，tail是看后多少行日志，例子如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询日志文件中的头10行日志</span></span><br><span class="line">head -n 10  test.log</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询日志文件除了最后10行的其他所有日志</span></span><br><span class="line">head -n -10  test.log</span><br></pre></td></tr></table></figure></p>
<h3 id="CAT-TAC："><a href="#CAT-TAC：" class="headerlink" title="CAT/TAC："></a>CAT/TAC：</h3><p>tac是倒序查看，是cat单词反写，例子如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询关键字的日志</span></span><br><span class="line">cat -n test.log |grep <span class="string">"debug"</span></span><br></pre></td></tr></table></figure></p>
<h3 id="PS"><a href="#PS" class="headerlink" title="PS"></a>PS</h3><p>该命令用于将某个时间点的进程运行情况选取下来并输出。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-A ：所有的进程均显示出来</span><br><span class="line">-a ：不与terminal有关的所有进程</span><br><span class="line">-u ：有效用户的相关进程</span><br><span class="line">-x ：一般与a参数一起使用，可列出较完整的信息</span><br><span class="line">-l ：较长，较详细地将PID的信息列出</span><br></pre></td></tr></table></figure>
<p>其实我们只要记住ps一般使用的命令参数搭配即可，它们并不多，如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看系统所有的进程数据</span></span><br><span class="line">ps aux</span><br><span class="line"><span class="comment"># 查看不与terminal有关的所有进程</span></span><br><span class="line">ps ax</span><br><span class="line"><span class="comment"># 查看系统所有的进程数据</span></span><br><span class="line">ps -lA</span><br><span class="line"><span class="comment"># 查看连同一部分进程树状态</span></span><br><span class="line">ps axjf</span><br></pre></td></tr></table></figure></p>
<h3 id="TOP"><a href="#TOP" class="headerlink" title="TOP"></a>TOP</h3><p>该命令是Linux下常用的性能分析工具，能够实时显示系统中各个进程的资源占用状况，类似于Windows的任务管理器。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-b 批处理</span><br><span class="line">-c 显示完整的治命令</span><br><span class="line">-I 忽略失效过程</span><br><span class="line">-s 保密模式</span><br><span class="line">-S 累积模式</span><br><span class="line">-i&lt;时间&gt; 设置间隔时间</span><br><span class="line">-u&lt;用户名&gt; 指定用户名</span><br><span class="line">-p&lt;进程号&gt; 指定进程</span><br><span class="line">-n&lt;次数&gt; 循环显示的次数</span><br></pre></td></tr></table></figure>
<h3 id="LSOF"><a href="#LSOF" class="headerlink" title="LSOF"></a>LSOF</h3><p>lsof -i: 端口号该命令用于查看某一端口的占用情况。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 比如查看8000端口使用情况</span></span><br><span class="line">lsof -i:8000</span><br><span class="line"></span><br><span class="line">COMMAND   PID USER   FD   TYPE  DEVICE SIZE/OFF NODE NAME</span><br><span class="line">lwfs    22065 root    6u  IPv4 4395053      0t0  TCP *:irdmi (LISTEN)</span><br><span class="line"><span class="comment"># 可以看到8000端口已经被轻量级文件系统转发服务lwfs占用</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示开启文件abc.txt的进程</span></span><br><span class="line">lsof abc.txt</span><br></pre></td></tr></table></figure></p>
<h3 id="NETSTAT"><a href="#NETSTAT" class="headerlink" title="NETSTAT"></a>NETSTAT</h3><p>该命令用于显示各种网络相关信息，如网络连接、路由表、接口状态 (Interface Statistics)，masquerade连接，多播成员(Multicast Memberships)等。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-a (all)显示所有选项，netstat默认不显示LISTEN相关</span><br><span class="line">-t (tcp)仅显示tcp相关选项</span><br><span class="line">-u (udp)仅显示udp相关选项</span><br><span class="line">-n 拒绝显示别名，能显示数字的全部转化成数字。(重要)</span><br><span class="line">-l 仅列出有在 Listen (监听) 的服務状态</span><br></pre></td></tr></table></figure>
<p>结合grep查询，找出运行在指定端口的进程。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">netstat -an | grep 61780</span><br><span class="line">netstat -an | grep <span class="string">':22'</span></span><br></pre></td></tr></table></figure></p>
<h3 id="CHOWN"><a href="#CHOWN" class="headerlink" title="CHOWN"></a>CHOWN</h3><p>改变文件的拥有者。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">chown [-cfhvR] [--<span class="built_in">help</span>] [--version] user[:group] file.</span><br><span class="line"></span><br><span class="line">user : 新的文件拥有者的使用者 ID</span><br><span class="line">group : 新的文件拥有者的使用者组(group)</span><br><span class="line">-c : 显示更改的部分的信息</span><br><span class="line">-f : 忽略错误信息</span><br><span class="line">-h :修复符号链接</span><br><span class="line">-v : 显示详细的处理信息</span><br><span class="line">-R : 处理指定目录以及其子目录下的所有文件</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将文件 file1.txt 的拥有者设为 runoob 群体的使用者 runoobgroup:</span></span><br><span class="line">chown runoob:runoobgroup file1.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将目前目录下的所有文件与子目录的拥有者皆设为 runoob，群体的使用者 runoobgroup:</span></span><br><span class="line">chown -R runoob:runoobgroup *</span><br></pre></td></tr></table></figure>
<h3 id="CHMOD"><a href="#CHMOD" class="headerlink" title="CHMOD"></a>CHMOD</h3><p>该命令用于管理文件或目录的权限。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">chmod [-cfvR] file.</span><br><span class="line"></span><br><span class="line">u 表示该文件的拥有者，g 表示与该文件的拥有者属于同一个群体(group)者，o 表示其他以外的人，a 表示这三者皆是。</span><br><span class="line">+ 表示增加权限、- 表示取消权限、= 表示唯一设定权限。</span><br><span class="line">r 表示可读取，w 表示可写入，x 表示可执行，X 表示只有当该文件是个子目录或者该文件已经被设定过为可执行。</span><br><span class="line">r=4，w=2，x=1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 此外chmod也可以用数字来表示权限</span></span><br><span class="line">chmod 777 file</span><br><span class="line"></span><br><span class="line"><span class="comment"># 其中a,b,c各为一个数字，分别表示User、Group、及Other的权限</span></span><br><span class="line">chmod abc file</span><br><span class="line">chmod ug=rwx,o=x file 和 chmod 771 file 效果相同</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将ex1.py设定为只有该文件拥有者可以执行</span></span><br><span class="line">chmod u+x ex1.py</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将目前目录下的所有文件与子目录皆设为任何人可读取</span></span><br><span class="line">chmod -R a+r *</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://chainradar.cn/2018/07/05/Charles--描述文件安装/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CHEN JIAN PING">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tester Chen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/05/Charles--描述文件安装/" itemprop="url">Charles--根证书安装</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-07-05T22:01:00+08:00">
                2018-07-05
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Charles/" itemprop="url" rel="index">
                    <span itemprop="name">Charles</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h3><p>顺利安装Charles根证书。</p>
<h3 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Mac：10.14.4</span><br><span class="line">iPhone：12.2</span><br><span class="line">Charles：4.2.8</span><br></pre></td></tr></table></figure>
<h3 id="为什么写"><a href="#为什么写" class="headerlink" title="为什么写"></a>为什么写</h3><p>最近iPhone升级到12.2，在尝试安装Charles根证书时谷歌浏览器不自动弹出证书安装提示。</p>
<h3 id="安装操作"><a href="#安装操作" class="headerlink" title="安装操作"></a>安装操作</h3><p>1、进入【菜单Help–&gt;SSL Proxying–&gt; Install Charles Root Certificate on a Mobile Device or Remote Browser】：<br><img src="/images/charles/howinstallca.jpg" alt></p>
<p>2、根据Charles上面的提示，设置好代理后通过<strong>Google Chrome</strong>浏览器访问chls.pro/ssl，奇怪的是并没有提示安装，而是直接进入了下载模式：<br><img src="/images/charles/3896.jpg" alt><br><img src="/images/charles/3897.jpg" alt></p>
<p>3、在手机尝试寻找安装方式未果，在网上搜索后发现有一条相关记录，但并没有结论。<br>想着可能和系统版本升级后兼容有关，于是想到使用自带的<strong>Safari</strong>浏览器试一试。<br>哟，正常提示安装（是亲儿子！）在浏览器中按提示操作即可：<br><img src="/images/charles/3898.jpg" alt></p>
<p>4、浏览器中操作完成后，并没有直接安装直接，而是放到了【设置–&gt;已下载描述文件】：<br><img src="/images/charles/3900.png" alt></p>
<p>5、我们进入【已下载描述文件】，按提示操作，即可安装成功：<br><img src="/images/charles/3901.jpg" alt></p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>Charles根证书安装建议使用Safari浏览器。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://chainradar.cn/2017/03/18/Appium App自动化03--iOS常用方法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CHEN JIAN PING">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tester Chen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/03/18/Appium App自动化03--iOS常用方法/" itemprop="url">Appium UI自动化03--iOS常用方法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-03-18T16:01:00+08:00">
                2017-03-18
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/APP自动化/" itemprop="url" rel="index">
                    <span itemprop="name">APP自动化</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h3><p>了解Appium iOS常用操作方法。</p>
<h3 id="Maven"><a href="#Maven" class="headerlink" title="Maven"></a>Maven</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;commons-lang3&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;3.8.1&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;io.appium&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;java-client&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;7.0.0&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.seleniumhq.selenium&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;selenium-remote-driver&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;3.141.59&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.testng&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;testng&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;6.9.6&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<h3 id="屏幕上下滑动"><a href="#屏幕上下滑动" class="headerlink" title="屏幕上下滑动"></a>屏幕上下滑动</h3><p>向上滑动：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">up</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    JavascriptExecutor js = (JavascriptExecutor) driver;</span><br><span class="line">    HashMap&lt;String, String&gt; scrollObject = <span class="keyword">new</span> HashMap&lt;String, String&gt;();</span><br><span class="line">    scrollObject.put(<span class="string">"direction"</span>, <span class="string">"up"</span>);</span><br><span class="line">    js.executeScript(<span class="string">"mobile: swipe"</span>, scrollObject);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>向下滑动：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">down</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    JavascriptExecutor js = (JavascriptExecutor) driver;</span><br><span class="line">    HashMap&lt;String, String&gt; scrollObject = <span class="keyword">new</span> HashMap&lt;String, String&gt;();</span><br><span class="line">    scrollObject.put(<span class="string">"direction"</span>, <span class="string">"down"</span>);</span><br><span class="line">    js.executeScript(<span class="string">"mobile: swipe"</span>, scrollObject);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="屏幕左右滑动"><a href="#屏幕左右滑动" class="headerlink" title="屏幕左右滑动"></a>屏幕左右滑动</h3><p>向右滑动：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">swipeScreenToRight</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x = driver.manage().window().getSize().getWidth();</span><br><span class="line">    <span class="keyword">int</span> y = driver.manage().window().getSize().getHeight();</span><br><span class="line">    <span class="keyword">new</span> TouchAction(driver).longPress(PointOption.point((<span class="keyword">int</span>)(x * <span class="number">0.1</span>), y / <span class="number">2</span>))</span><br><span class="line">        .moveTo(ElementOption.point((<span class="keyword">int</span>)(x * <span class="number">0.9</span>), y / <span class="number">2</span>))</span><br><span class="line">        .release().perform();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>向左滑动：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">swipeScreenToLeft</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x = driver.manage().window().getSize().getWidth();</span><br><span class="line">    <span class="keyword">int</span> y = driver.manage().window().getSize().getHeight();</span><br><span class="line">    <span class="keyword">new</span> TouchAction(driver).longPress(PointOption.point((<span class="keyword">int</span>)(x * <span class="number">0.9</span>), y / <span class="number">2</span>))</span><br><span class="line">        .moveTo(ElementOption.point((<span class="keyword">int</span>)(x * <span class="number">0.1</span>), y / <span class="number">2</span>))</span><br><span class="line">        .release().perform();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="元素操作"><a href="#元素操作" class="headerlink" title="元素操作"></a>元素操作</h3><p>在元素上方向左滑动</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">swipeElement</span><span class="params">(WebElement webElement)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 不能使用press方法，会产生点击事件</span></span><br><span class="line">    <span class="keyword">new</span> TouchAction(driver).longPress(ElementOption.element(webElement))</span><br><span class="line">        .moveTo(ElementOption.point(webElement.getLocation().getX() / <span class="number">5</span>, webElement.getLocation().getY()))</span><br><span class="line">        .release().perform();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>长按元素</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">longPress</span><span class="params">(WebElement webElement, <span class="keyword">int</span> timeout)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">new</span> TouchAction(driver).longPress(ElementOption.element(webElement))</span><br><span class="line">        .waitAction(WaitOptions.waitOptions(Duration.ofMillis(timeout))).release().perform();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>Appium java-client库更新到6.x后（我们这里用的7.x），滑动swipe()已弃用。</p>
<p><a href="https://github.com/TesterChen/AutomationTest/tree/master/firstAppAutoTest" target="_blank" rel="noopener">跳转至本节代码 GitHub</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://chainradar.cn/2017/02/15/Appium App自动化02--快速开始/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CHEN JIAN PING">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tester Chen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/15/Appium App自动化02--快速开始/" itemprop="url">Appium UI自动化02--快速开始</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-02-15T22:01:00+08:00">
                2017-02-15
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/APP自动化/" itemprop="url" rel="index">
                    <span itemprop="name">APP自动化</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h3><p>新建Maven项目，通过Java代码启动iPhone真机的目标App，执行点击动作后退出App。</p>
<h3 id="环境信息"><a href="#环境信息" class="headerlink" title="环境信息"></a>环境信息</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Mac --&gt; 10.14.4</span><br><span class="line">iPhone Real Device --&gt; 12.2</span><br><span class="line">Appium --&gt; 1.12.1</span><br><span class="line">Xcode --&gt; 10.2</span><br></pre></td></tr></table></figure>
<h3 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h3><p>1、新建Maven项目、添加Maven引用、加入测试代码；<br>2、启动Appium服务；<br>3、通过TestNG运行测试脚本；<br><em>首次运行若App未启动，请进入手机【设置 -&gt; 通用 -&gt; 描述文件与设备管理】检查描述文件是否被信任</em>。</p>
<h3 id="Maven依赖"><a href="#Maven依赖" class="headerlink" title="Maven依赖"></a>Maven依赖</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;commons-lang3&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;3.8.1&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;io.appium&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;java-client&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;7.0.0&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.seleniumhq.selenium&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;selenium-remote-driver&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;3.141.59&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.testng&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;testng&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;6.9.6&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.net.MalformedURLException;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.By;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.remote.DesiredCapabilities;</span><br><span class="line"><span class="keyword">import</span> org.testng.annotations.AfterTest;</span><br><span class="line"><span class="keyword">import</span> org.testng.annotations.BeforeTest;</span><br><span class="line"><span class="keyword">import</span> org.testng.annotations.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.appium.java_client.AppiumDriver;</span><br><span class="line"><span class="keyword">import</span> io.appium.java_client.MobileElement;</span><br><span class="line"><span class="keyword">import</span> io.appium.java_client.ios.IOSDriver;</span><br><span class="line"><span class="keyword">import</span> io.appium.java_client.remote.MobileCapabilityType;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StartApp</span> </span>&#123;</span><br><span class="line">    AppiumDriver&lt;MobileElement&gt; driver;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@BeforeTest</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// startWayOne();</span></span><br><span class="line">        startWayTwo();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getAppDriver</span><span class="params">()</span> <span class="keyword">throws</span> MalformedURLException </span>&#123;</span><br><span class="line">        <span class="comment">// 点击第一个职位</span></span><br><span class="line">        driver.findElement(By.xpath(<span class="string">"(//XCUIElementTypeStaticText[contains(@name,'测试')])[1]"</span>)).click();</span><br><span class="line">        sleep(<span class="number">5000</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterTest</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">quite</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        driver.quit();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">startWayOne</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        DesiredCapabilities capabilities = <span class="keyword">new</span> DesiredCapabilities();</span><br><span class="line">        capabilities.setCapability(<span class="string">"platformName"</span>, <span class="string">"iOS"</span>);</span><br><span class="line">        capabilities.setCapability(<span class="string">"platformVersion"</span>, <span class="string">"12.2"</span>);</span><br><span class="line">        capabilities.setCapability(<span class="string">"automationName"</span>, <span class="string">"XCUITest"</span>);</span><br><span class="line">        capabilities.setCapability(<span class="string">"deviceName"</span>, <span class="string">"iPhone"</span>);</span><br><span class="line">        <span class="comment">// liepin app，还可以使用"app ":本地.ipa文件路径</span></span><br><span class="line">        capabilities.setCapability(<span class="string">"bundleId"</span>, <span class="string">"com.lietou.insw-c-ios-iphone"</span>);</span><br><span class="line">        <span class="comment">// 只有一台设备时可以填写auto</span></span><br><span class="line">        capabilities.setCapability(<span class="string">"udid"</span>, <span class="string">"auto"</span>);</span><br><span class="line">        <span class="comment">// 解决App启动慢或失败问题，appium 1.12.0新增</span></span><br><span class="line">        capabilities.setCapability(<span class="string">"eventLoopIdleDelaySec"</span>, <span class="number">10</span>);</span><br><span class="line">        <span class="comment">// 自定义超时时间</span></span><br><span class="line">        capabilities.setCapability(<span class="string">"newCommandTimeout"</span>, <span class="number">120</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            driver = <span class="keyword">new</span> IOSDriver&lt;MobileElement&gt;(<span class="keyword">new</span> URL(<span class="string">"http://127.0.0.1:4723/wd/hub"</span>), capabilities);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (MalformedURLException e) &#123;</span><br><span class="line">            System.out.println(<span class="string">"Please start the appium service first"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">startWayTwo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        DesiredCapabilities capabilities = <span class="keyword">new</span> DesiredCapabilities();</span><br><span class="line">        capabilities.setCapability(MobileCapabilityType.PLATFORM_NAME, <span class="string">"iOS"</span>);</span><br><span class="line">        capabilities.setCapability(MobileCapabilityType.PLATFORM_VERSION, <span class="string">"12.2"</span>);</span><br><span class="line">        capabilities.setCapability(MobileCapabilityType.AUTOMATION_NAME, <span class="string">"XCUITest"</span>);</span><br><span class="line">        capabilities.setCapability(MobileCapabilityType.DEVICE_NAME, <span class="string">"iPhone"</span>);</span><br><span class="line">        <span class="comment">// 只有一台设备时可以填写auto</span></span><br><span class="line">        capabilities.setCapability(MobileCapabilityType.UDID, <span class="string">"auto"</span>);</span><br><span class="line">        <span class="comment">// 自定义超时时间</span></span><br><span class="line">        capabilities.setCapability(MobileCapabilityType.NEW_COMMAND_TIMEOUT, <span class="number">120</span>);</span><br><span class="line">        <span class="comment">// ios应用的唯一标识，还可以使用"app ":本地.ipa文件路径</span></span><br><span class="line">        capabilities.setCapability(<span class="string">"bundleId"</span>, <span class="string">"com.lietou.insw-c-ios-iphone"</span>);</span><br><span class="line">        <span class="comment">// 解决App启动慢或失败问题，appium 1.12.0新增</span></span><br><span class="line">        capabilities.setCapability(<span class="string">"eventLoopIdleDelaySec"</span>, <span class="number">10</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            driver = <span class="keyword">new</span> IOSDriver&lt;MobileElement&gt;(<span class="keyword">new</span> URL(<span class="string">"http://127.0.0.1:4723/wd/hub"</span>), capabilities);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (MalformedURLException e) &#123;</span><br><span class="line">            System.out.println(<span class="string">"Please start the appium service first"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 等待方法是为了让我们更好的看到自动化执行结果</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sleep</span><span class="params">(<span class="keyword">int</span> seconds)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(seconds);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>Appium UI自动化对真机的性能要求相对较高。<br>机器性能不高时，元素寻址定位时会占用较长时间，建议使用性能更好的机型以获取更好的执行速度。</p>
<p><a href="https://github.com/TesterChen/AutomationTest/tree/master/firstAppAutoTest" target="_blank" rel="noopener">跳转至本节代码 GitHub</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://chainradar.cn/2017/02/13/Appium App自动化01--通过Appium启动App/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CHEN JIAN PING">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tester Chen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/13/Appium App自动化01--通过Appium启动App/" itemprop="url">Appium UI自动化01--通过Appium Desktop启动iOS App</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-02-13T22:01:00+08:00">
                2017-02-13
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/APP自动化/" itemprop="url" rel="index">
                    <span itemprop="name">APP自动化</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h3><p>在环境配置章节中我们已经使用Appium自带的WDA完成配置，现尝试通过Appium Desktop拉起(启动)目标App。</p>
<h3 id="环境信息"><a href="#环境信息" class="headerlink" title="环境信息"></a>环境信息</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Mac --&gt; 10.14.4</span><br><span class="line">iPhone Real Device --&gt; 12.2</span><br><span class="line">Appium --&gt; 1.12.1</span><br><span class="line">Xcode --&gt; 10.2</span><br></pre></td></tr></table></figure>
<h3 id="获取设备udid"><a href="#获取设备udid" class="headerlink" title="获取设备udid"></a>获取设备udid</h3><p>通过命令获取设备udid：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">idevice_id -l</span><br></pre></td></tr></table></figure></p>
<p>通过iTunes获取到设备的udid：<br><img src="/images/appium/itunes1.png" alt>默认显示的不是udid，点击如下显示区域切换即可获取到udid：<br><img src="/images/appium/itunes2.png" alt></p>
<h3 id="启动App"><a href="#启动App" class="headerlink" title="启动App"></a>启动App</h3><p>我们以启动微信为例。<br>打开Appium桌面并启动Appium服务，点击菜单Appium -&gt; New Session Window，配置完成后保存或者直接【Start Session】：<br><img src="/images/appium/capabilities.png" alt></p>
<p>配置文本信息如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="comment"># 平台类型</span></span><br><span class="line">    <span class="string">"platformName"</span>: <span class="string">"iOS"</span>,</span><br><span class="line">    <span class="comment"># 不一定是你的手机系统版本，需要是你的Xcode支持的版本</span></span><br><span class="line">    <span class="string">"platformVersion"</span>: <span class="string">"12.2"</span>,</span><br><span class="line">    <span class="comment"># 设备名称，也就是iPhone的名称</span></span><br><span class="line">    <span class="string">"deviceName"</span>: <span class="string">"iPhone"</span>,</span><br><span class="line">    <span class="comment"># 理解为固定参数值</span></span><br><span class="line">    <span class="string">"automationName"</span>: <span class="string">"XCUITest"</span>,</span><br><span class="line">    <span class="comment"># 设备udid，只有一台设备时值可以使用“auto”</span></span><br><span class="line">    <span class="string">"udid"</span>: <span class="string">"auto"</span>,</span><br><span class="line">    <span class="comment"># 要启动的App，可使用”app”属性替换</span></span><br><span class="line">    <span class="string">"bundleId"</span>: <span class="string">"com.tencent.xin"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><a href="https://github.com/appium/appium/blob/master/docs/en/writing-running-appium/caps.md" target="_blank" rel="noopener">More Appium Desired Capabilities</a></p>
<h3 id="可能的异常"><a href="#可能的异常" class="headerlink" title="可能的异常"></a>可能的异常</h3><p>1、启动时异常：Could not connect to server; are you sure it’s running?<br>点击顶部的【Automatic Server】，再【Start Session】就可以了</p>
<p><img src="/images/appium/connect.png" alt></p>
<p>2、App无法启动<br>Appium的服务停止后再次启动时，Appium会重新安装WAD App，我们需要重新操作信任描述文件：<br>设置 -&gt; 通用 -&gt; 描述文件与设备管理，找到目标描述文件，信任描述文件，再次尝试启动App即可。</p>
<p>3、Appium Inspector加载App元素时日志异常：Failure: Failure getting list of active applications: (null)<br>尝试新增配置eventLoopIdleDelaySec：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 注意参数类型是number，不是text</span></span><br><span class="line"><span class="string">"eventLoopIdleDelaySec"</span>：10</span><br></pre></td></tr></table></figure></p>
<p><a href="https://github.com/facebook/WebDriverAgent/issues/1054" target="_blank" rel="noopener">了解更多关于这个问题</a></p>
<h3 id="疑惑"><a href="#疑惑" class="headerlink" title="疑惑"></a>疑惑</h3><p>到这里，你可能会觉得疑惑，我们一直没有通过Xcode做任何操作。<br>是的，不需要，我们在Xcode配置完成之后，运行【Test】是为了验证配置是否正确。<br>我们使用Appium内置的WDA，每次Appium会自动调起WDA服务：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[XCUITest] Setting up real device</span><br><span class="line">[XCUITest] Using WDA path: <span class="string">'/Applications/Appium.app/Contents/Resources/app/node_modules/appium/node_modules/appium-xcuitest-driver/WebDriverAgent'</span></span><br><span class="line">[XCUITest] Using WDA agent: <span class="string">'/Applications/Appium.app/Contents/Resources/app/node_modules/appium/node_modules/appium-xcuitest-driver/WebDriverAgent/WebDriverAgent.xcodeproj'</span></span><br><span class="line">......</span><br><span class="line">[XCUITest] Trying to start WebDriverAgent 1 <span class="built_in">times</span> with 10000ms interval</span><br></pre></td></tr></table></figure></p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>当我们使用Appium安装目录下的WDA时，可以直接通过Appium启动iOS App。<br>Appium服务重新启动后，再次调用WDA时，会在设备重新安装WebDriverAgent.app，我们需要重新信任App描述文件。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://chainradar.cn/2017/01/13/Appium App自动化00--环境配置/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CHEN JIAN PING">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tester Chen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/01/13/Appium App自动化00--环境配置/" itemprop="url">Appium UI自动化00--环境配置</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-01-13T22:01:00+08:00">
                2017-01-13
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/APP自动化/" itemprop="url" rel="index">
                    <span itemprop="name">APP自动化</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h3><p>之前一直使用公司的电脑进行App UI自动化相关开发工作    ，现在自己的Mac上配置环境。<br>完成环境配置后，能通过Mac的Appium启动iPhone手机中目标App。</p>
<h3 id="因素"><a href="#因素" class="headerlink" title="因素"></a>因素</h3><p>影响环境搭建的因素主要：iPhone系统版本、Appium版本、Xcode版本，最终环境信息：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Mac --&gt; 10.14.4</span><br><span class="line">iPhone Real Device --&gt; 12.2</span><br><span class="line">Appium --&gt; 1.12.1</span><br><span class="line">Xcode --&gt; 10.2</span><br></pre></td></tr></table></figure></p>
<h3 id="配置过程"><a href="#配置过程" class="headerlink" title="配置过程"></a>配置过程</h3><h4 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h4><p>1、安装Appium桌面<br><a href="http://appium.io/" target="_blank" rel="noopener">去官方下载安装</a></p>
<p>2、安装homebrew：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 确认是否安装</span></span><br><span class="line">brew -v</span><br><span class="line"><span class="comment"># 安装</span></span><br><span class="line">/usr/bin/ruby -e <span class="string">"<span class="variable">$(curl –fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)</span>"</span></span><br></pre></td></tr></table></figure></p>
<p>3、安装npm及node.js：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 确认是否安装</span></span><br><span class="line">npm -v</span><br><span class="line"><span class="comment"># 安装</span></span><br><span class="line">brew install npm</span><br></pre></td></tr></table></figure></p>
<p>此命令执行后，npme和node.js会全部安装完毕。</p>
<h4 id="依赖安装"><a href="#依赖安装" class="headerlink" title="依赖安装"></a>依赖安装</h4><p>安装libimobiledevice依赖：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install libimobiledevice --HEAD</span><br></pre></td></tr></table></figure></p>
<p>Xcode版本在8以上或真机iOS版本在9.3以上时，需要安装ios-deploy依赖：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># npm和brew安装方式任选其一即可</span></span><br><span class="line">npm install -g ios-deploy</span><br><span class="line">brew install ios-deploy</span><br></pre></td></tr></table></figure></p>
<h4 id="配置Xcode"><a href="#配置Xcode" class="headerlink" title="配置Xcode"></a>配置Xcode</h4><p>接下来的配置过程在官方有完善的文档资料，包括自动配置和手动配置。<br>1、切换至Appium 自带WDA（WebDrvierAgent）目录执行配置命令：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 切换至Appium 自带WDA（WebDrvierAgent）目录</span></span><br><span class="line"><span class="built_in">cd</span> /Applications/Appium.app/Contents/Resources/app/node_modules/appium/node_modules/appium-xcuitest-driver/WebDriverAgent/</span><br><span class="line"><span class="comment"># 命令1</span></span><br><span class="line">mkdir -p Resources/WebDriverAgent.bundle</span><br><span class="line"><span class="comment"># 命令2</span></span><br><span class="line">./Scripts/bootstrap.sh -d</span><br></pre></td></tr></table></figure></p>
<p>2、配置Xcode，在打开的目录中双击WebDriverAgent.xcodeproj，它会在Xcode中打开。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 切换至Appium自带WDA（WebDrvierAgent）目录</span></span><br><span class="line"><span class="built_in">cd</span> /Applications/Appium.app/Contents/Resources/app/node_modules/appium/node_modules/appium-xcuitest-driver/WebDriverAgent/</span><br><span class="line"><span class="comment"># 在窗口中打开目录</span></span><br><span class="line">open .</span><br></pre></td></tr></table></figure></p>
<p>具体Xcode配置省略，可参考此处进行配置：<br><strong>重点需要做的是：配置你的Apple和修改包名称（不再使用com.facebook）</strong><br><a href="http://appium.io/docs/en/drivers/ios-xcuitest-real-devices/#full-manual-configuration" target="_blank" rel="noopener">点击跳转至官方配置说明</a><br><a href="https://blog.csdn.net/u012873868/article/details/81132413" target="_blank" rel="noopener">appium ios 真机自动化环境搭建</a></p>
<h3 id="遇到问题"><a href="#遇到问题" class="headerlink" title="遇到问题"></a>遇到问题</h3><h4 id="版本兼容问题"><a href="#版本兼容问题" class="headerlink" title="版本兼容问题"></a>版本兼容问题</h4><p>我的iPhone升级到12.2，Xcode 10.1未能支持SDK 12.2，再进我在App Store的升级列表中看到10.2可以支持SDK 12.2。<br>升级Xcode时提示需要升级Mac OS，遂将MAC OS升级到了10.14.4，升级完成后Xcode成功升级至10.2。<br>升级后可以从App Store查看是否支持最新的SDK版本，如下：<br><img src="/images/appium/xcodesdk.png" alt></p>
<h4 id="WDA问题"><a href="#WDA问题" class="headerlink" title="WDA问题"></a>WDA问题</h4><p>自行从GitHub上下载了WDA的最新版本，修改配置后，Appium一直未能正常拉起App，同时报错奇怪的错误，显示有com.facebook的相关冲突。<br>这个冲突让我想到是否配置Appium自带的WDA可以解决问题，通过配置Appium自带的WDA后，Xcode可Test通过，也可以通过Appium启动App。<br>（<em>所以上面的配置直接建议先配置Appium自带的WDA</em>）</p>
<h3 id="经验"><a href="#经验" class="headerlink" title="经验"></a>经验</h3><p>1、不建议轻易地升级iPhone系统或Xcode的版本，因为想降回去还是很麻烦的。</p>
<p>2、认真阅读Appium日志的报错信息<br>出现错误后，阅读Appium弹出的错误是一方面，更多的异常信息打印在Appium的日志中，结合两者获取到关键错误信息。</p>
<p>3、如何寻找解决方案<br>很多问题在GitHub上是已知并且已经解决，GitHub上Appium开发者很耐心地对很多问题都做了回答和修复。<br>使用我们拿到的关键错误信息，直接在问题列表中进行搜索即可。<br><a href="https://github.com/facebook/WebDriverAgent/issues/" target="_blank" rel="noopener">GitHub Appium 问题列表</a></p>
<p>4、WDA<br>WDA有两种方式：一种是自定义直接从GitHub下载，一种是使用Appium自带的，通过这一次的踩坑，建议优先使用自带的WDA。<br><a href="https://github.com/appium/WebDriverAgent" target="_blank" rel="noopener">WDA GitHub地址</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://chainradar.cn/2016/10/05/Selenium Web自动化09--TestNG实现并发执行/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CHEN JIAN PING">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tester Chen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/10/05/Selenium Web自动化09--TestNG实现并发执行/" itemprop="url">Selenium Web自动化09--TestNG实现并发执行</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-10-05T17:21:00+08:00">
                2016-10-05
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/WEB自动化/" itemprop="url" rel="index">
                    <span itemprop="name">WEB自动化</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h3><p>了解TestNG并发执行基本实现</p>
<h3 id="TestNG与本地Driver并发"><a href="#TestNG与本地Driver并发" class="headerlink" title="TestNG与本地Driver并发"></a>TestNG与本地Driver并发</h3><p>我们写一个测试测试类，在这个测试类中我们使用本地Driver，同时设计两个测试方法。<br>可以实现在同一类型浏览器下并发执行多个测试脚本。</p>
<p>其中用到了ThreadLocal，简单介绍如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ThreadLocal的实例代表了一个线程局部的变量，每条线程都只能看到自己的值，并不会意识到其它的线程中也存在该变量。</span><br><span class="line">它采用采用空间来换取时间的方式，解决多线程中相同变量的访问冲突问题。</span><br></pre></td></tr></table></figure></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.testerchen.qa.multiple;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.By;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.WebDriver;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.chrome.ChromeDriver;</span><br><span class="line"><span class="keyword">import</span> org.testng.annotations.AfterMethod;</span><br><span class="line"><span class="keyword">import</span> org.testng.annotations.BeforeMethod;</span><br><span class="line"><span class="keyword">import</span> org.testng.annotations.Test;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 借助TestNG.xml的配置实现本地浏览器并发执行(TestNG.xml)</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">multipleTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> ThreadLocal&lt;WebDriver&gt; ThreadDriver = <span class="keyword">new</span> ThreadLocal&lt;WebDriver&gt;();</span><br><span class="line">	String projectPath = System.getProperty(<span class="string">"user.dir"</span>);</span><br><span class="line"></span><br><span class="line">	<span class="meta">@BeforeMethod</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">beforeMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.setProperty(<span class="string">"webdriver.chrome.driver"</span>, projectPath + <span class="string">"/src/main/resource/driver/chromedriver"</span>);</span><br><span class="line">		WebDriver driver = <span class="keyword">new</span> ChromeDriver();</span><br><span class="line">		ThreadDriver.set(driver);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span>()</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">first</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		ThreadDriver.get().get(<span class="string">"https://www.baidu.com"</span>);</span><br><span class="line">		ThreadDriver.get().findElement(By.id(<span class="string">"kw"</span>)).sendKeys(<span class="string">"test"</span>);</span><br><span class="line">		ThreadDriver.get().findElement(By.id(<span class="string">"su"</span>)).click();</span><br><span class="line">		sleep(<span class="number">3000</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span>()</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">second</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		ThreadDriver.get().get(<span class="string">"https://www.baidu.com"</span>);</span><br><span class="line">		ThreadDriver.get().findElement(By.id(<span class="string">"kw"</span>)).sendKeys(<span class="string">"selenium"</span>);</span><br><span class="line">		ThreadDriver.get().findElement(By.id(<span class="string">"su"</span>)).click();</span><br><span class="line">		sleep(<span class="number">3000</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@AfterMethod</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		ThreadDriver.get().quit();</span><br><span class="line">		ThreadDriver.remove();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 等待方法是为了让我们更好的看到自动化执行结果</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sleep</span><span class="params">(<span class="keyword">int</span> seconds)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Thread.sleep(seconds);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>TestNG.xml配置如下：<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- parallel可以为：</span><br><span class="line">  methods : 每个method使用一个线程</span><br><span class="line">  tests ：每个&lt;test&gt;标签中的所有方法使用一个线程</span><br><span class="line">  classes : 每个<span class="class"><span class="keyword">class</span>使用一个线程 </span></span><br><span class="line"><span class="class">  </span></span><br><span class="line">  thread-count:每次执行测试的线程并发数</span><br><span class="line">  --&gt;</span><br><span class="line">&lt;suite name=<span class="string">"test"</span> parallel=<span class="string">"methods"</span> thread-count=<span class="string">"2"</span>&gt;</span><br><span class="line">	&lt;test name=<span class="string">"test"</span>&gt;</span><br><span class="line">		&lt;classes&gt;</span><br><span class="line">			&lt;<span class="class"><span class="keyword">class</span> <span class="title">name</span></span>=<span class="string">"com.testerchen.qa.multiple.multipleTest"</span> /&gt;</span><br><span class="line">		&lt;/classes&gt;</span><br><span class="line">	&lt;/test&gt;</span><br><span class="line">&lt;/suite&gt;</span><br></pre></td></tr></table></figure></p>
<p>接下来，运行TestNG.xml，看到的效果是：同时启动两个Chrome浏览器，同步执行我们两个Test中脚本。<br>注意：<br>执行TestNG.xml时，不是在文件中右键运行，而是在IDE的资源管理器中右键 –&gt; Run As –&gt; TestNG Suite。</p>
<p><img src="/images/selenium/thread01.png" alt></p>
<h3 id="TestNG与Grid远程分布式并发"><a href="#TestNG与Grid远程分布式并发" class="headerlink" title="TestNG与Grid远程分布式并发"></a>TestNG与Grid远程分布式并发</h3><p>这里用到了@Parameters注解，通过xml传递的参数，实现初始化不同Driver。<br>可以实现在不同类型浏览器并发执行脚本。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@Parameters(&#123; <span class="string">"seleniumHubHost"</span>, <span class="string">"seleniumHubPort"</span>, <span class="string">"browserType"</span> &#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.testerchen.qa.multiple;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.net.MalformedURLException;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.By;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.remote.DesiredCapabilities;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.remote.RemoteWebDriver;</span><br><span class="line"><span class="keyword">import</span> org.testng.annotations.AfterMethod;</span><br><span class="line"><span class="keyword">import</span> org.testng.annotations.BeforeMethod;</span><br><span class="line"><span class="keyword">import</span> org.testng.annotations.Parameters;</span><br><span class="line"><span class="keyword">import</span> org.testng.annotations.Test;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通过Grid远程浏览器并发执行</span></span><br><span class="line"><span class="comment"> * 需要借助TestNG.xml的配置实现(RemoteTestNG.xml)</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">remoteMultipleTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> ThreadLocal&lt;RemoteWebDriver&gt; ThreadRemoteDriver = <span class="keyword">new</span> ThreadLocal&lt;RemoteWebDriver&gt;();</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Parameters</span>(&#123; <span class="string">"seleniumHubHost"</span>, <span class="string">"seleniumHubPort"</span>, <span class="string">"browserType"</span> &#125;)</span><br><span class="line">	<span class="meta">@BeforeMethod</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">beforeMetho</span><span class="params">(String seleniumHubHost, String seleniumHubPort, String browserType)</span> <span class="keyword">throws</span> MalformedURLException </span>&#123;</span><br><span class="line">		RemoteWebDriver driver;</span><br><span class="line">		DesiredCapabilities capabilities;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">switch</span> (browserType) &#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">"firefox"</span>:</span><br><span class="line">			capabilities = DesiredCapabilities.firefox();</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">"chrome"</span>:</span><br><span class="line">			capabilities = DesiredCapabilities.chrome();</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">default</span>:</span><br><span class="line">			capabilities = DesiredCapabilities.chrome();</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		driver = <span class="keyword">new</span> RemoteWebDriver(<span class="keyword">new</span> URL(<span class="string">"http://"</span> + seleniumHubHost + <span class="string">":"</span> + seleniumHubPort + <span class="string">"/wd/hub"</span>),</span><br><span class="line">				capabilities);</span><br><span class="line">		ThreadRemoteDriver.set(driver);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		ThreadRemoteDriver.get().get(<span class="string">"https://www.baidu.com"</span>);</span><br><span class="line">		ThreadRemoteDriver.get().findElement(By.id(<span class="string">"kw"</span>)).sendKeys(<span class="string">"test"</span>);</span><br><span class="line">		ThreadRemoteDriver.get().findElement(By.id(<span class="string">"su"</span>)).click();</span><br><span class="line">		sleep(<span class="number">3000</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		ThreadRemoteDriver.get().get(<span class="string">"https://www.baidu.com"</span>);</span><br><span class="line">		ThreadRemoteDriver.get().findElement(By.id(<span class="string">"kw"</span>)).sendKeys(<span class="string">"selenium"</span>);</span><br><span class="line">		ThreadRemoteDriver.get().findElement(By.id(<span class="string">"su"</span>)).click();</span><br><span class="line">		sleep(<span class="number">3000</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@AfterMethod</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		ThreadRemoteDriver.get().quit();</span><br><span class="line">		ThreadRemoteDriver.remove();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 等待方法是为了让我们更好的看到自动化执行结果</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sleep</span><span class="params">(<span class="keyword">int</span> seconds)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Thread.sleep(seconds);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>RemoteTestNG.xml配置如下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- parallel可以为： </span><br><span class="line">	methods : 每个method使用一个线程 </span><br><span class="line">	tests ：每个&lt;test&gt;标签中的所有方法使用一个线程 </span><br><span class="line">	classes : 每个<span class="class"><span class="keyword">class</span>使用一个线程 </span></span><br><span class="line"><span class="class">	</span></span><br><span class="line">	thread-count:每次执行测试的线程并发数</span><br><span class="line">	--&gt;</span><br><span class="line">&lt;suite name=<span class="string">"test"</span> parallel=<span class="string">"tests"</span> thread-count=<span class="string">"2"</span>&gt;</span><br><span class="line">	&lt;test name=<span class="string">"test firefox"</span>&gt;</span><br><span class="line">		&lt;parameter name=<span class="string">"seleniumHubHost"</span> value=<span class="string">"127.0.0.1"</span> /&gt;</span><br><span class="line">		&lt;parameter name=<span class="string">"seleniumHubPort"</span> value=<span class="string">"4444"</span> /&gt;</span><br><span class="line">		&lt;parameter name=<span class="string">"browserType"</span> value=<span class="string">"firefox"</span> /&gt;</span><br><span class="line">		&lt;classes&gt;</span><br><span class="line">			&lt;<span class="class"><span class="keyword">class</span> <span class="title">name</span></span>=<span class="string">"com.testerchen.qa.multiple.remoteMultipleTest"</span> /&gt;</span><br><span class="line">		&lt;/classes&gt;</span><br><span class="line">	&lt;/test&gt;</span><br><span class="line"></span><br><span class="line">	&lt;test name=<span class="string">"test chrome"</span>&gt;</span><br><span class="line">		&lt;parameter name=<span class="string">"seleniumHubHost"</span> value=<span class="string">"127.0.0.1"</span> /&gt;</span><br><span class="line">		&lt;parameter name=<span class="string">"seleniumHubPort"</span> value=<span class="string">"4444"</span> /&gt;</span><br><span class="line">		&lt;parameter name=<span class="string">"browserType"</span> value=<span class="string">"chrome"</span> /&gt;</span><br><span class="line">		&lt;classes&gt;</span><br><span class="line">			&lt;<span class="class"><span class="keyword">class</span> <span class="title">name</span></span>=<span class="string">"com.testerchen.qa.multiple.remoteMultipleTest"</span> /&gt;</span><br><span class="line">		&lt;/classes&gt;</span><br><span class="line">	&lt;/test&gt;</span><br><span class="line">&lt;/suite&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>接下来，运行RemoteTestNG.xml，看到的效果是：同时启动Chrome和Firefox浏览器，同步执行我们两个Test中脚本。</p>
<p><img src="/images/selenium/thread02.png" alt></p>
<h3 id="TestNG-注解实现并发"><a href="#TestNG-注解实现并发" class="headerlink" title="TestNG 注解实现并发"></a>TestNG 注解实现并发</h3><p>实现单个Test的并发执行。<br>执行后看到的效果是：首先同时启动两个浏览器并发执行first()的脚本；执行结束后，再启动一个浏览器执行second()的脚本。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.testerchen.qa.multiple;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.By;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.WebDriver;</span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.chrome.ChromeDriver;</span><br><span class="line"><span class="keyword">import</span> org.testng.annotations.AfterMethod;</span><br><span class="line"><span class="keyword">import</span> org.testng.annotations.BeforeMethod;</span><br><span class="line"><span class="keyword">import</span> org.testng.annotations.Test;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通过<span class="doctag">@Test</span>注解实现单测试方法迸发</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Test</span>(threadPoolSize = 2, invocationCount = 2)</span></span><br><span class="line"><span class="comment"> * threadPoolSize 线程池大小，invocationCount 方法需要运行的次数</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">threadMultipleTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> ThreadLocal&lt;WebDriver&gt; ThreadDriver = <span class="keyword">new</span> ThreadLocal&lt;WebDriver&gt;();</span><br><span class="line">	String projectPath = System.getProperty(<span class="string">"user.dir"</span>);</span><br><span class="line"></span><br><span class="line">	<span class="meta">@BeforeMethod</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">beforeMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.setProperty(<span class="string">"webdriver.chrome.driver"</span>, projectPath + <span class="string">"/src/main/resource/driver/chromedriver"</span>);</span><br><span class="line">		WebDriver driver = <span class="keyword">new</span> ChromeDriver();</span><br><span class="line">		ThreadDriver.set(driver);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span>(threadPoolSize = <span class="number">2</span>, invocationCount = <span class="number">2</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">first</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		ThreadDriver.get().get(<span class="string">"https://www.baidu.com"</span>);</span><br><span class="line">		ThreadDriver.get().findElement(By.id(<span class="string">"kw"</span>)).sendKeys(<span class="string">"test"</span>);</span><br><span class="line">		ThreadDriver.get().findElement(By.id(<span class="string">"su"</span>)).click();</span><br><span class="line">		sleep(<span class="number">3000</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span>(threadPoolSize = <span class="number">2</span>, invocationCount = <span class="number">1</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">second</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		ThreadDriver.get().get(<span class="string">"https://www.baidu.com"</span>);</span><br><span class="line">		ThreadDriver.get().findElement(By.id(<span class="string">"kw"</span>)).sendKeys(<span class="string">"selenium"</span>);</span><br><span class="line">		ThreadDriver.get().findElement(By.id(<span class="string">"su"</span>)).click();</span><br><span class="line">		sleep(<span class="number">3000</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@AfterMethod</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		ThreadDriver.get().quit();</span><br><span class="line">		ThreadDriver.remove();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 等待方法是为了让我们更好的看到自动化执行结果</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sleep</span><span class="params">(<span class="keyword">int</span> seconds)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Thread.sleep(seconds);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h3><p><a href="https://github.com/TesterChen/AutomationTest/tree/master/multipleTest" target="_blank" rel="noopener">本节源代码 GitHub</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://chainradar.cn/2016/09/05/Selenium Web自动化08--ExtentReports美化TestNG报告/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CHEN JIAN PING">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tester Chen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/09/05/Selenium Web自动化08--ExtentReports美化TestNG报告/" itemprop="url">Selenium Web自动化08--美化TestNG报告</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-09-05T08:06:00+08:00">
                2016-09-05
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/WEB自动化/" itemprop="url" rel="index">
                    <span itemprop="name">WEB自动化</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h3><p>使用ExtentReports美化TestNG默认测试报告。<br>介绍最常用到的两种实现方式：Listener ITestListener与Ireporter接口。</p>
<h3 id="效果预览"><a href="#效果预览" class="headerlink" title="效果预览"></a>效果预览</h3><p><img src="/images/selenium/report.png" alt></p>
<h3 id="实现ITestListener"><a href="#实现ITestListener" class="headerlink" title="实现ITestListener"></a>实现ITestListener</h3><p>实现ITestListener接口的类在加入TestNG后，会在用例执行期间，测试类加载后，每个测试方法@Test之前前后调用执行。</p>
<p>1、添加Maven依赖，两种方式均需要添加此依赖：<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- https:<span class="comment">//mvnrepository.com/artifact/com.google.code.gson/gson --&gt;</span></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">	&lt;groupId&gt;com.google.code.gson&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;gson&lt;/artifactId&gt;</span><br><span class="line">	&lt;version&gt;2.8.5&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- https:<span class="comment">//mvnrepository.com/artifact/com.aventstack/extentreports --&gt;</span></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">	&lt;groupId&gt;com.aventstack&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;extentreports&lt;/artifactId&gt;</span><br><span class="line">	&lt;version&gt;3.1.0&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure></p>
<p>2、在项目中(可任意位置)新建类ExtentTestNGITestListener.java：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.awt.Dimension;</span><br><span class="line"><span class="keyword">import</span> java.awt.Rectangle;</span><br><span class="line"><span class="keyword">import</span> java.awt.Robot;</span><br><span class="line"><span class="keyword">import</span> java.awt.Toolkit;</span><br><span class="line"><span class="keyword">import</span> java.awt.image.BufferedImage;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.imageio.ImageIO;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.testng.ITestContext;</span><br><span class="line"><span class="keyword">import</span> org.testng.ITestListener;</span><br><span class="line"><span class="keyword">import</span> org.testng.ITestResult;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.aventstack.extentreports.ExtentReports;</span><br><span class="line"><span class="keyword">import</span> com.aventstack.extentreports.ExtentTest;</span><br><span class="line"><span class="keyword">import</span> com.aventstack.extentreports.MediaEntityBuilder;</span><br><span class="line"><span class="keyword">import</span> com.aventstack.extentreports.reporter.ExtentHtmlReporter;</span><br><span class="line"><span class="keyword">import</span> com.aventstack.extentreports.reporter.configuration.ChartLocation;</span><br><span class="line"><span class="keyword">import</span> com.aventstack.extentreports.reporter.configuration.Theme;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExtentTestNGITestListener</span> <span class="keyword">implements</span> <span class="title">ITestListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 输出的目录和文件名可以修改</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> ExtentReports extent = ExtentManager.createInstance(<span class="string">"test-output/extent.html"</span>);</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> ThreadLocal&lt;ExtentTest&gt; parentTest = <span class="keyword">new</span> ThreadLocal&lt;ExtentTest&gt;();</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> ThreadLocal&lt;ExtentTest&gt; test = <span class="keyword">new</span> ThreadLocal&lt;ExtentTest&gt;();</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">onStart</span><span class="params">(ITestContext context)</span> </span>&#123;</span><br><span class="line">		ExtentTest parent = extent.createTest(getClass().getName());</span><br><span class="line">		parentTest.set(parent);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">onFinish</span><span class="params">(ITestContext context)</span> </span>&#123;</span><br><span class="line">		extent.flush();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">onTestStart</span><span class="params">(ITestResult result)</span> </span>&#123;</span><br><span class="line">		ExtentTest child = ((ExtentTest) parentTest.get()).createNode(result.getMethod().getMethodName());</span><br><span class="line">		test.set(child);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">onTestSuccess</span><span class="params">(ITestResult result)</span> </span>&#123;</span><br><span class="line">		((ExtentTest) test.get()).pass(<span class="string">"Test passed"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">onTestFailure</span><span class="params">(ITestResult result)</span> </span>&#123;</span><br><span class="line">		((ExtentTest) test.get()).fail(result.getThrowable());</span><br><span class="line">		<span class="comment">// 错误时截图</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="comment">// 截图名称固定，避免结果文件夹图片过多</span></span><br><span class="line">			captureScreen(System.getProperty(<span class="string">"user.dir"</span>) + <span class="string">"/test-output/"</span>, <span class="string">"screenshot.png"</span>);</span><br><span class="line">			test.get().fail(<span class="string">"fail details"</span>, MediaEntityBuilder.createScreenCaptureFromPath(<span class="string">"screenshot.png"</span>).build());</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;	&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">onTestSkipped</span><span class="params">(ITestResult result)</span> </span>&#123;</span><br><span class="line">		((ExtentTest) test.get()).skip(result.getThrowable());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">onTestFailedButWithinSuccessPercentage</span><span class="params">(ITestResult result)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 截图方法</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">captureScreen</span><span class="params">(String fileName, String folder)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">		Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize();</span><br><span class="line">		Rectangle screenRectangle = <span class="keyword">new</span> Rectangle(screenSize);</span><br><span class="line">		Robot robot = <span class="keyword">new</span> Robot();</span><br><span class="line">		BufferedImage image = robot.createScreenCapture(screenRectangle);</span><br><span class="line">		<span class="comment">// 截图保存的路径</span></span><br><span class="line">		File screenFile = <span class="keyword">new</span> File(fileName);</span><br><span class="line">		<span class="comment">// 如果路径不存在,则创建</span></span><br><span class="line">		<span class="keyword">if</span> (!screenFile.getParentFile().exists()) &#123;</span><br><span class="line">			screenFile.getParentFile().mkdirs();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// 判断文件是否存在，不存在就创建文件</span></span><br><span class="line">		<span class="keyword">if</span> (!screenFile.exists() &amp;&amp; !screenFile.isDirectory()) &#123;</span><br><span class="line">			screenFile.mkdir();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		File file = <span class="keyword">new</span> File(screenFile, folder);</span><br><span class="line">		ImageIO.write(image, <span class="string">"png"</span>, file);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 内部类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ExtentManager</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> ExtentReports extent;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ExtentReports <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (extent == <span class="keyword">null</span>)</span><br><span class="line">			createInstance(<span class="string">"test-output/extent.html"</span>);</span><br><span class="line">		<span class="keyword">return</span> extent;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ExtentReports <span class="title">createInstance</span><span class="params">(String fileName)</span> </span>&#123;</span><br><span class="line">		ExtentHtmlReporter htmlReporter = <span class="keyword">new</span> ExtentHtmlReporter(fileName);</span><br><span class="line">		htmlReporter.config().setTestViewChartLocation(ChartLocation.BOTTOM);</span><br><span class="line">		htmlReporter.config().setChartVisibilityOnOpen(<span class="keyword">true</span>);</span><br><span class="line">		htmlReporter.config().setTheme(Theme.STANDARD);</span><br><span class="line">		htmlReporter.config().setDocumentTitle(fileName);</span><br><span class="line">		htmlReporter.config().setEncoding(<span class="string">"utf-8"</span>);</span><br><span class="line">		htmlReporter.config().setReportName(fileName);</span><br><span class="line"></span><br><span class="line">		extent = <span class="keyword">new</span> ExtentReports();</span><br><span class="line">		extent.attachReporter(htmlReporter);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 作者相关信息</span></span><br><span class="line">		extent.createTest(<span class="string">"chenjianping"</span>).assignAuthor(<span class="string">"QA"</span>).pass(<span class="string">"details"</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> extent;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3、在项目中(可任意位置)新建TestNG.xml：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE suite SYSTEM <span class="string">"https://testng.org/testng-1.0.dtd"</span> &gt;</span><br><span class="line"></span><br><span class="line">&lt;suite name=<span class="string">"Suite"</span> verbose=<span class="string">"1"</span>&gt;</span><br><span class="line"></span><br><span class="line">	&lt;listeners&gt;</span><br><span class="line">		&lt;--  根输入类ExtentTestNGITestListener的路径 --&gt;</span><br><span class="line">		&lt;listener <span class="class"><span class="keyword">class</span>-<span class="title">name</span></span>=<span class="string">"com.selenium.learn.testng.ExtentTestNGITestListener"</span> /&gt;</span><br><span class="line">	&lt;/listeners&gt;</span><br><span class="line"></span><br><span class="line">	&lt;test name=<span class="string">"FirstWebAutoTest"</span>&gt;</span><br><span class="line">		&lt;classes&gt;</span><br><span class="line">			&lt;-- 这是已经写好的测试脚本 --&gt;</span><br><span class="line">			&lt;<span class="class"><span class="keyword">class</span> <span class="title">name</span></span>=<span class="string">"com.selenium.learn.script.FirstWebAutoTest"</span> /&gt;</span><br><span class="line">		&lt;/classes&gt;</span><br><span class="line">	&lt;/test&gt;</span><br><span class="line"></span><br><span class="line">	&lt;test name=<span class="string">"ReprotTest"</span>&gt;</span><br><span class="line">		&lt;classes&gt;</span><br><span class="line">			&lt;-- 这是已经写好的测试脚本 --&gt;</span><br><span class="line">			&lt;<span class="class"><span class="keyword">class</span> <span class="title">name</span></span>=<span class="string">"com.selenium.learn.script.ReprotTest"</span> /&gt;</span><br><span class="line">		&lt;/classes&gt;</span><br><span class="line">	&lt;/test&gt;</span><br><span class="line">&lt;/suite&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>4、在上一步创建的TestNG.xml上右键选择Run As – TestNG Suite</p>
<h3 id="实现Ireporter"><a href="#实现Ireporter" class="headerlink" title="实现Ireporter"></a>实现Ireporter</h3><p>实现IReporter接口加入TestNG后，在每次测试执行完后被调用执行，可以获取所有执行的testsuite、testcase的一些信息，可以用以生成一份测试报告。</p>
<p>1、在项目中(可任意位置)ExtentTestNGIReporterListener.java：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Calendar;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.testng.IReporter;</span><br><span class="line"><span class="keyword">import</span> org.testng.IResultMap;</span><br><span class="line"><span class="keyword">import</span> org.testng.ISuite;</span><br><span class="line"><span class="keyword">import</span> org.testng.ISuiteResult;</span><br><span class="line"><span class="keyword">import</span> org.testng.ITestContext;</span><br><span class="line"><span class="keyword">import</span> org.testng.ITestResult;</span><br><span class="line"><span class="keyword">import</span> org.testng.Reporter;</span><br><span class="line"><span class="keyword">import</span> org.testng.xml.XmlSuite;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.aventstack.extentreports.ExtentReports;</span><br><span class="line"><span class="keyword">import</span> com.aventstack.extentreports.ExtentTest;</span><br><span class="line"><span class="keyword">import</span> com.aventstack.extentreports.Status;</span><br><span class="line"><span class="keyword">import</span> com.aventstack.extentreports.reporter.ExtentHtmlReporter;</span><br><span class="line"><span class="keyword">import</span> com.aventstack.extentreports.reporter.configuration.ChartLocation;</span><br><span class="line"><span class="keyword">import</span> com.aventstack.extentreports.reporter.configuration.Theme;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExtentTestNGIReporterListener</span> <span class="keyword">implements</span> <span class="title">IReporter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 输出的目录和文件名称</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String OUTPUT_FOLDER = <span class="string">"test-output/"</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String FILE_NAME = <span class="string">"extent.html"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ExtentReports extent;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">generateReport</span><span class="params">(List&lt;XmlSuite&gt; xmlSuites, List&lt;ISuite&gt; suites, String outputDirectory)</span> </span>&#123;</span><br><span class="line">        init();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (ISuite suite : suites) &#123;</span><br><span class="line">            Map&lt;String, ISuiteResult&gt; results = suite.getResults();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (ISuiteResult result : results.values()) &#123;</span><br><span class="line">                ITestContext context = result.getTestContext();</span><br><span class="line">                buildTestNodes(context.getFailedTests(), Status.FAIL);</span><br><span class="line">                buildTestNodes(context.getSkippedTests(), Status.SKIP);</span><br><span class="line">                buildTestNodes(context.getPassedTests(), Status.PASS);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (String str : Reporter.getOutput()) &#123;</span><br><span class="line">            extent.setTestRunnerOutput(str);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        extent.flush();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ExtentHtmlReporter htmlReporter = <span class="keyword">new</span> ExtentHtmlReporter(OUTPUT_FOLDER + FILE_NAME);</span><br><span class="line">        <span class="comment">// 这里修改报告页面Title</span></span><br><span class="line">        htmlReporter.config().setDocumentTitle(<span class="string">"ExtentReports - Created by TestNG Listener"</span>);</span><br><span class="line">        htmlReporter.config().setReportName(<span class="string">"ExtentReports - Created by TestNG Listener"</span>);</span><br><span class="line">        htmlReporter.config().setTestViewChartLocation(ChartLocation.BOTTOM);</span><br><span class="line">        htmlReporter.config().setTheme(Theme.STANDARD);</span><br><span class="line"></span><br><span class="line">        extent = <span class="keyword">new</span> ExtentReports();</span><br><span class="line">        extent.attachReporter(htmlReporter);</span><br><span class="line">        extent.setReportUsesManualConfiguration(<span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">buildTestNodes</span><span class="params">(IResultMap tests, Status status)</span> </span>&#123;</span><br><span class="line">        ExtentTest test;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (tests.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (ITestResult result : tests.getAllResults()) &#123;</span><br><span class="line">                test = extent.createTest(result.getMethod().getMethodName());</span><br><span class="line"></span><br><span class="line">                <span class="keyword">for</span> (String group : result.getMethod().getGroups())</span><br><span class="line">                    test.assignCategory(group);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (result.getThrowable() != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    test.log(status, result.getThrowable());</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    test.log(status, <span class="string">"Test "</span> + status.toString().toLowerCase() + <span class="string">"ed"</span>);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                test.getModel().setStartTime(getTime(result.getStartMillis()));</span><br><span class="line">                test.getModel().setEndTime(getTime(result.getEndMillis()));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Date <span class="title">getTime</span><span class="params">(<span class="keyword">long</span> millis)</span> </span>&#123;</span><br><span class="line">        Calendar calendar = Calendar.getInstance();</span><br><span class="line">        calendar.setTimeInMillis(millis);</span><br><span class="line">        <span class="keyword">return</span> calendar.getTime();      </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>2、在项目中(可任意位置)新建TestNG.xml：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE suite SYSTEM <span class="string">"https://testng.org/testng-1.0.dtd"</span> &gt;</span><br><span class="line"></span><br><span class="line">&lt;suite name=<span class="string">"Suite"</span> verbose=<span class="string">"1"</span>&gt;</span><br><span class="line"></span><br><span class="line">	&lt;listeners&gt;</span><br><span class="line">		&lt;--  根输入类ExtentTestNGITestListener的路径 --&gt;</span><br><span class="line">		&lt;listener <span class="class"><span class="keyword">class</span>-<span class="title">name</span></span>=<span class="string">"com.selenium.learn.testng.ExtentTestNGIReporterListener"</span> /&gt;</span><br><span class="line">	&lt;/listeners&gt;</span><br><span class="line"></span><br><span class="line">	&lt;test name=<span class="string">"FirstWebAutoTest"</span>&gt;</span><br><span class="line">		&lt;classes&gt;</span><br><span class="line">			&lt;-- 这是已经写好的测试脚本 --&gt;</span><br><span class="line">			&lt;<span class="class"><span class="keyword">class</span> <span class="title">name</span></span>=<span class="string">"com.selenium.learn.script.FirstWebAutoTest"</span> /&gt;</span><br><span class="line">		&lt;/classes&gt;</span><br><span class="line">	&lt;/test&gt;</span><br><span class="line"></span><br><span class="line">	&lt;test name=<span class="string">"ReprotTest"</span>&gt;</span><br><span class="line">		&lt;classes&gt;</span><br><span class="line">			&lt;-- 这是已经写好的测试脚本 --&gt;</span><br><span class="line">			&lt;<span class="class"><span class="keyword">class</span> <span class="title">name</span></span>=<span class="string">"com.selenium.learn.script.ReprotTest"</span> /&gt;</span><br><span class="line">		&lt;/classes&gt;</span><br><span class="line">	&lt;/test&gt;</span><br><span class="line">&lt;/suite&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>3、在上一步创建的TestNG.xml上右键选择Run As – TestNG Suite</p>
<h3 id="自定义监听类"><a href="#自定义监听类" class="headerlink" title="自定义监听类"></a>自定义监听类</h3><p>前面我们是通过xml文件的配置实现自定义监听类。<br>还可以通过在测试脚本类中添加自定义监听类，我们直接运行测试脚本即可调用优化后的报告模板。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 若需要直接通过运行测试脚本的方式调用ExtentReports报告，则在类添加<span class="doctag">@Listeners</span>即可</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Listeners</span>(ExtentTestNGIReporterListener.class) 或</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Listeners</span>(ExtentTestNGITestListener.class)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Listeners</span>(ExtentTestNGIReporterListener.class)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FirstWebAutoTest</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span></span>&#123;</span><br><span class="line">		......</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h3><p>此部分代码源码 <a href="https://github.com/TesterChen/AutomationTest/tree/master/reports" target="_blank" rel="noopener">GitHub reports</a></p>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><p><a href="https://testerhome.com/topics/9994" target="_blank" rel="noopener">官方V3文档翻译</a><br><a href="https://sq.163yun.com/blog/article/193926986823745536" target="_blank" rel="noopener">testng框架Listener介绍及测试结果的收集</a><br><a href="https://testerhome.com/topics/6851" target="_blank" rel="noopener">Macaca结合ExtentReports</a><br><a href="http://www.mamicode.com/info-detail-2330482.html" target="_blank" rel="noopener">丰富自定义实现IReporter</a><br><a href="https://www.cnblogs.com/chongyou/p/7544000.html" target="_blank" rel="noopener">自定义测试用例数据至报告</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://chainradar.cn/2016/08/04/Selenium Web自动化07--常见问题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CHEN JIAN PING">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tester Chen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/04/Selenium Web自动化07--常见问题/" itemprop="url">Selenium Web自动化07--常见问题</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-08-04T08:06:00+08:00">
                2016-08-04
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/WEB自动化/" itemprop="url" rel="index">
                    <span itemprop="name">WEB自动化</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h3><p>能解决自动化脚本调试过程中遇到的大部分问题。</p>
<h3 id="浏览器没启动"><a href="#浏览器没启动" class="headerlink" title="浏览器没启动"></a>浏览器没启动</h3><h4 id="driver位置不正确"><a href="#driver位置不正确" class="headerlink" title="driver位置不正确"></a>driver位置不正确</h4><p>出现这个错误时，报错信息会明确提示可执行的driver文件不存在：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">FAILED CONFIGURATION: </span><br><span class="line">java.lang.IllegalStateException: The driver executable does not exist: </span><br><span class="line">/Users/testerchen/oxygen/learn/src1/main/resource/driver/chromedriver</span><br></pre></td></tr></table></figure>处理方式：确认driver路径是否存在并修改。</p>
<h4 id="浏览器版本与driver不匹配"><a href="#浏览器版本与driver不匹配" class="headerlink" title="浏览器版本与driver不匹配"></a>浏览器版本与driver不匹配</h4><p>我本地chrome浏览器版本为73，我特意去官网下载了匹配chrome74版本的driver，运行时则会抛错：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">FAILED CONFIGURATION: </span><br><span class="line">org.openqa.selenium.SessionNotCreatedException: </span><br><span class="line">session not created: This version of ChromeDriver only supports Chrome version <span class="number">74</span></span><br></pre></td></tr></table></figure>处理方式：<br>本地浏览器和drvier文件之间有一个对应关系，driver不能使用比它对应版本更老的浏览器。<br>比如上面的问题，我需要下载针对73版本的driver，或者升级我的本地chrome浏览器。</p>
<h4 id="driver文件损坏"><a href="#driver文件损坏" class="headerlink" title="driver文件损坏"></a>driver文件损坏</h4><p>driver文件损坏之后，运行时会报出如下错误：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">FAILED CONFIGURATION: </span><br><span class="line">java.lang.IllegalStateException: The driver is not executable: /Users/testerchen/oxygen/learn/src/main/resource/driver/chromedriver</span><br></pre></td></tr></table></figure></p>
<p>怎么确定文件是不是正常的呢？<br>windows下可以直接双击运行driver.exe，如果正常打开控制台，则说明文件没有损坏。<br>mac下将driver文件直接拖入终端回车运行，通过终端提示判断driver运行是正常，文件正常时终端日志类似：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Starting ChromeDriver <span class="number">73.0</span>.3683.68 (<span class="number">47787</span>ec04b6e38e22703e856e101e840b65afe72) on port <span class="number">9515</span></span><br><span class="line">Only local connections are allowed.</span><br><span class="line">Please protect ports used by ChromeDriver and related test frameworks to prevent access by malicious code.</span><br></pre></td></tr></table></figure></p>
<h3 id="找不到元素"><a href="#找不到元素" class="headerlink" title="找不到元素"></a>找不到元素</h3><p>元素找不到的情况会比较多，这里给总结常见的几种情形。</p>
<h4 id="xpath书写错误"><a href="#xpath书写错误" class="headerlink" title="xpath书写错误"></a>xpath书写错误</h4><p>我将百度搜索框的xpath由//input[@id=’kw’]改为了//input[@id=’kw1’]，运行抛出如下错误：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">org.openqa.selenium.NoSuchElementException: no such element: </span><br><span class="line">Unable to locate element: &#123;<span class="string">"method"</span>:<span class="string">"xpath"</span>,<span class="string">"selector"</span>:<span class="string">"//input[@id='kw1']"</span>&#125;</span><br></pre></td></tr></table></figure>处理方式：<br>我们在处理这类问题时需要首先确定报错的页面，再在对应的页面中通过浏览器开发者工具确认xpath是否能找到对应元素。<br>注意：匹配多个元素时，建议在xpath或代码上进行优化，确保目标元素唯一匹配。</p>
<h4 id="未及时切换页面"><a href="#未及时切换页面" class="headerlink" title="未及时切换页面"></a>未及时切换页面</h4><p>我们通过A页面打开B页面，切换到B页面进行操作，操作完成之后，想直接再对A页面进行操作，这样可以吗？<br>这样是不可以的，这样大多数情况下脚本会报出和xpath书写错误同样的异常，因为元素在当前默认页面并不存在。<br>解决方式：在不同页面之间操作，需要及时切换默认页面。</p>
<h4 id="目标页面已关闭"><a href="#目标页面已关闭" class="headerlink" title="目标页面已关闭"></a>目标页面已关闭</h4><p>我们将默认页面关闭之后，未及时切换默认页面，而是直接操作下一个页面元素，运行会抛出如下错误：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">FAILED CONFIGURATION: </span><br><span class="line">org.openqa.selenium.NoSuchWindowException: no such window: target window already closed</span><br></pre></td></tr></table></figure>处理方式：<br>遇到这类问题，我们需要做的就是在关闭页面时及时切换默认页面。<br>我们在重新封装clsoe()方法时，有时会选择在clsoe()方法之后，再调用我们自定义的selecLastWindow()方法，避免这类问题出现。</p>
<h4 id="元素动态变化"><a href="#元素动态变化" class="headerlink" title="元素动态变化"></a>元素动态变化</h4><p>这类错误出现时有一个特征：元素数量会动态变化或伴随着页面更新，最常见的场景是循环删除数据。<br>我们通过传入的xpath循环点击删除按钮，代码如下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deletes</span><span class="params">(String xpath)</span> </span>&#123;</span><br><span class="line">	<span class="comment">// 通过xpath找到所有删除按钮</span></span><br><span class="line">	List&lt;WebElement&gt; elementList = driver.findElements(By.xpath(xpath));</span><br><span class="line">	<span class="keyword">int</span> listSize = elementList.size();</span><br><span class="line">	<span class="comment">// 循环点击删除按钮</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> index = <span class="number">0</span>; index &lt; listSize; index++) &#123;</span><br><span class="line">		elementList.get(index).click();</span><br><span class="line">		<span class="comment">// 删除后，刷新页面，继续删除</span></span><br><span class="line">		driver.navigate().refresh();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>上面的这段代码有什么问题吗？<br>这明显有问题，for循环应该用减减，因为元素越来越少，像这样写：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deletes</span><span class="params">(String xpath)</span> </span>&#123;</span><br><span class="line">	<span class="comment">// 通过xpath找到所有删除按钮</span></span><br><span class="line">	List&lt;WebElement&gt; elementList = driver.findElements(By.xpath(xpath));</span><br><span class="line">	<span class="comment">// 索引比数量少1</span></span><br><span class="line">	<span class="keyword">int</span> listSize = elementList.size() - <span class="number">1</span>;</span><br><span class="line">	<span class="comment">// 循环点击删除按钮</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> index = listSize; index &gt;=<span class="number">0</span>; index-- &#123;</span><br><span class="line">		elementList.get(index).click();</span><br><span class="line">		<span class="comment">// 删除后，刷新页面，继续删除</span></span><br><span class="line">		driver.navigate().refresh();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>我们再看，这样有没有问题？<br>我们运行一下看看，额，除了删除第一个正常，后续的删除都不正常，报这样的错误：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">org.openqa.selenium.StaleElementReferenceException: </span><br><span class="line">stale element reference: element is not attached to the page document</span><br></pre></td></tr></table></figure>让我们通过一段测试代码看一看页面刷新前后元素的hashcode：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">List&lt;WebElement&gt; elementList1 = driver.findElements(By.xpath(<span class="string">"//a[@data-selector='selected-label']"</span>));</span><br><span class="line"><span class="keyword">for</span>(WebElement ele: elementList1) &#123;</span><br><span class="line">	System.out.println(ele.hashCode());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">driver.navigate().refresh();</span><br><span class="line">System.out.println(<span class="string">"=刷新页面后同样元素的hashcode="</span>);</span><br><span class="line"></span><br><span class="line">List&lt;WebElement&gt; elementList2 = driver.findElements(By.xpath(<span class="string">"//a[@data-selector='selected-label']"</span>));</span><br><span class="line"><span class="keyword">for</span>(WebElement ele: elementList2) &#123;</span><br><span class="line">	System.out.println(ele.hashCode());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>输出结果：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">-<span class="number">884477669</span></span><br><span class="line">-<span class="number">884477668</span></span><br><span class="line">-<span class="number">884477667</span></span><br><span class="line">-<span class="number">884477666</span></span><br><span class="line">-<span class="number">884477665</span></span><br><span class="line">-<span class="number">884477664</span></span><br><span class="line">-<span class="number">884477663</span></span><br><span class="line">-<span class="number">884477662</span></span><br><span class="line">=刷新页面后同样元素的hashcode=</span><br><span class="line">-<span class="number">1481510540</span></span><br><span class="line">-<span class="number">1481510539</span></span><br><span class="line">-<span class="number">1481510538</span></span><br><span class="line">-<span class="number">1481510537</span></span><br><span class="line">-<span class="number">1481510536</span></span><br><span class="line">-<span class="number">1481510535</span></span><br><span class="line">-<span class="number">1481510534</span></span><br><span class="line">-<span class="number">1481510533</span></span><br></pre></td></tr></table></figure></p>
<p>这样看来罪魁祸首就无处躲藏了，因为页面刷新之后元素的hashcode发生了改变，driver无法根据之前的hashcode找到对应的元素。<br>那我们如果就想实现删除一个元素，刷新页面再删除呢？实现方式不唯一，可以考虑这样写：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deletes</span><span class="params">(String xpath)</span> </span>&#123;</span><br><span class="line">List&lt;WebElement&gt; elementList;</span><br><span class="line"><span class="comment">// 根据元素列表数确定量需要循环的次数</span></span><br><span class="line"><span class="keyword">int</span> listSize = driver.findElements(By.xpath(xpath)).size();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> index = <span class="number">0</span>; index &lt; listSize; index++) &#123;</span><br><span class="line">	<span class="comment">// 每次操作之前获取元素列表</span></span><br><span class="line">	elementList = driver.findElements(By.xpath(xpath));</span><br><span class="line">	<span class="comment">// 每次都操作第1个元素，走到所有元素操作完成</span></span><br><span class="line">	elementList.get(<span class="number">0</span>).click();</span><br><span class="line">	driver.navigate().refresh();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://chainradar.cn/2016/07/03/Selenium Web自动化06--进阶实用方法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CHEN JIAN PING">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tester Chen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/07/03/Selenium Web自动化06--进阶实用方法/" itemprop="url">Selenium Web自动化06--进阶实用方法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-07-03T22:21:00+08:00">
                2016-07-03
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/WEB自动化/" itemprop="url" rel="index">
                    <span itemprop="name">WEB自动化</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h3><p>能完成相对复杂的操作，进一步将自动化动作串连起来。</p>
<h3 id="Cookie管理"><a href="#Cookie管理" class="headerlink" title="Cookie管理"></a>Cookie管理</h3><p>对浏览器的Cookie进行操作，大多用于控制页面的展示，如页面弹层或文本提示。</p>
<style>
table th:first-of-type {
    width: 150px;
}
table th:nth-of-type(2) {
    width: 80px;
}
</style>

<table>
<thead>
<tr>
<th>方法名</th>
<th>返回值类型</th>
<th>功能说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>addCookie()</td>
<td>void</td>
<td>新增Cookie</td>
</tr>
<tr>
<td>getCookieNamed()</td>
<td>Cookie</td>
<td>获取并返回指定名称的Cookkie，在Cookie中能拿到更多详细数据</td>
</tr>
<tr>
<td>deleteCookieNamed()</td>
<td>void</td>
<td>删除指定名称的Cookie</td>
</tr>
<tr>
<td>getCookies()</td>
<td>Set</td>
<td>获取并以Set&#60;Cookie&#62;返回当前域名下所有Cookie</td>
</tr>
</tbody>
</table>
<p>代码示例：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用到的Cookie包</span></span><br><span class="line"><span class="keyword">import</span> org.openqa.selenium.Cookie;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 增加cookie</span></span><br><span class="line">Cookie cookie = <span class="keyword">new</span> Cookie(<span class="string">"mykey"</span>, <span class="string">"myvalue"</span>);</span><br><span class="line">driver.manage().addCookie(cookie);</span><br><span class="line"><span class="comment">// 获取并打印cookie，Cookie对象中可以拿到更多数据，这里取出域名</span></span><br><span class="line">System.out.println(<span class="string">"mykey的值："</span> + driver.manage().getCookieNamed(<span class="string">"mykey"</span>).getValue());</span><br><span class="line">System.out.println(<span class="string">"mykey所在域名："</span> + driver.manage().getCookieNamed(<span class="string">"mykey"</span>).getDomain());</span><br><span class="line"><span class="comment">// 删除指定cookie</span></span><br><span class="line">driver.manage().deleteCookieNamed(<span class="string">"mykey"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果key不存在那么会返回一个null</span></span><br><span class="line">Cookie nullCookie = driver.manage().getCookieNamed(<span class="string">"mykey"</span>);</span><br><span class="line">System.out.println(<span class="string">"删除mykey后，再获取它的值："</span> + nullCookie);</span><br><span class="line"><span class="comment">// 若此时再去获取Cookie对象的其他属性，会抛出空指针异常</span></span><br><span class="line"><span class="comment">// System.out.println("mykey的值：" + nullCookie.getValue());</span></span><br><span class="line">		</span><br><span class="line"><span class="comment">// 遍历当前域名下cookie</span></span><br><span class="line">System.out.println(<span class="string">"================"</span>);</span><br><span class="line">Set&lt;Cookie&gt; cookies = driver.manage().getCookies();</span><br><span class="line"><span class="keyword">for</span> (Cookie ck : cookies) &#123;</span><br><span class="line">	System.out.println(<span class="string">"cookie == "</span>+ ck.getName() + <span class="string">":"</span> + ck.getValue());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>运行后输出结果如下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mykey的值：myvalue</span><br><span class="line">mykey所在域名：www.baidu.com</span><br><span class="line">删除mykey后，再获取它的值：：<span class="keyword">null</span></span><br><span class="line">================</span><br><span class="line">cookie == delPer:<span class="number">0</span></span><br><span class="line">cookie == BIDUPSID:F4052AC3F67D7F5AB03BDB40D489A247</span><br><span class="line">cookie == BDORZ:B490B5EBF6F3CD402E515D22BCDA1598</span><br><span class="line">cookie == PSTM:<span class="number">1554289527</span></span><br><span class="line">cookie == H_PS_PSSID:<span class="number">1433_21086_28770_28721_28557_28584_28604_28626_28605</span></span><br><span class="line">cookie == BD_UPN:<span class="number">123253</span></span><br><span class="line">cookie == BD_HOME:<span class="number">0</span></span><br><span class="line">cookie == BAIDUID:F4052AC3F67D7F5AB03BDB40D489A247:FG=<span class="number">1</span></span><br></pre></td></tr></table></figure></p>
<p>我们在浏览器中可以看到，预期的Cookie已经被添加进去：<br><img src="/images/selenium/addcookie.png" alt></p>
<h3 id="切换默认区域"><a href="#切换默认区域" class="headerlink" title="切换默认区域"></a>切换默认区域</h3><p>有时候页面中会嵌入frame/iframe，我们无法直接操作frame/iframe中的元素时，就需要切换至frame/iframe中，操作完成之后再切换回默认页面。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 支持id或者name</span></span><br><span class="line">driver.switchTo().frame(<span class="string">"user"</span>);</span><br><span class="line"><span class="comment">// 通过元素定位的方式切换</span></span><br><span class="line">WebElement element = driver.findElement(By.xpath(<span class="string">"//frame[@id='user']"</span>));</span><br><span class="line">driver.switchTo().frame(element);</span><br><span class="line"><span class="comment">// 通过frame的索引切换</span></span><br><span class="line">driver.switchTo().frame(<span class="number">1</span>);</span><br><span class="line"><span class="comment">// 切换至默认页面或frame</span></span><br><span class="line">driver.switchTo().defaultContent();</span><br></pre></td></tr></table></figure></p>
<h3 id="切换页面"><a href="#切换页面" class="headerlink" title="切换页面"></a>切换页面</h3><p>在新打开页面或者关闭当前页面后，需要切换默认页面，关闭当前页面后需要重新设置当前页面，否则后续执行会报错。<br>driver.getWindowHandles()返回一个有序的LinkedHashSet，我们可以根据打开顺序切换页面。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 切换至最后一个打开的页面</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">selectLastWindow</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	Set&lt;String&gt; handles = driver.getWindowHandles();</span><br><span class="line">	<span class="keyword">int</span> num = <span class="number">0</span>, aim = handles.size() -<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span> (String winHandle : handles) &#123;</span><br><span class="line">		<span class="keyword">if</span> (aim == num) &#123;</span><br><span class="line">			driver.switchTo().window(winHandle);</span><br><span class="line">		&#125;</span><br><span class="line">		num++;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 根据页面title切换页面</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">selectWindowByTitle</span><span class="params">(String windowTitle)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (String winHandle : driver.getWindowHandles()) &#123;</span><br><span class="line">		<span class="keyword">if</span> (driver.switchTo().window(winHandle).getTitle().equals(windowTitle)) &#123;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="截图"><a href="#截图" class="headerlink" title="截图"></a>截图</h3><p>用于记录失败时的执行情况，方便定位问题。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用TakesScreenshot截取浏览器部分图，这里需要传入存储的位置和图片名称</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getScreenShot</span><span class="params">(String path)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">		File sourceFile = ((TakesScreenshot) driver1).getScreenshotAs(OutputType.FILE);</span><br><span class="line">		FileUtils.copyFile(sourceFile, <span class="keyword">new</span> File(path));</span><br><span class="line">	&#125; <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">		ex.printStackTrace();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">CHEN JIAN PING</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">47</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">10</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">28</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">CHEN JIAN PING</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  

  

  

  

</body>
</html>
